---
title: 动静分离
mathjax: true
categories:
  - Nginx
tags:
  - Nginx
abbrlink: db0c1f1d
date: 2021-06-16 10:15:34
---

#### 静态资源部署在nginx服务器

nginx来当做静态资源服务器

来自80端口的请求会去nginx服务器根路径下的data文件夹查找

`http://xxx.xxx.xxx.xx/static/a/logo.png` 会请求根路径下 `/data/static/a/logo.png`

```
http {
    include       mime.types;
    default_type  application/octet-stream;


    server {
        listen       80;
        server_name  xxx.xxx.xxx.xxx;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location /static/ {
            root /data/;
        }

    }
}
```

#### 转发到静态资源服务器

转发时使用负载均衡配置

```
http {
    include       mime.types;
    default_type  application/octet-stream;
    upstream  stack_pools {
            server 172.25.254.134:80 weight=5;
    }
    upstream  dynamic_pools {
            server 172.25.254.135:80 weight=5;
    }
    server {
        listen       80;
        server_name  xxx.xxx.xxx.xx;
        location / {
            root   html;
            index  index.html index.htm;
            proxy_pass http://dynamic_pools;
        }
        location /image/ {
            proxy_pass http://stack_pools;
        }
        location /dynamic/ {
            roxy_pass http://dynamic_pools;
        }
    }
}
```
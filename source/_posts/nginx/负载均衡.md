---
title: 负载均衡
mathjax: true
categories:
  - Nginx
tags:
  - Nginx

date: 2021-06-15 18:35:22
---

#### 配置

```
http {
  upstream myServer{
      ip_hash;
      server localhost:1111 weight=10;
      server localhost:2222;
      fair;
  }
  listen       port;
  server_name  xxx.xxx.xxx.xx;

  #charset koi8-r;

  #access_log  logs/host.access.log  main;

  location / {
      proxy_pass http://myServer; 
  }
}
```


#### 轮询策略

每个请求按时间的顺序逐一分配到不同德尔服务器中，如果服务器挂了，可以自动剔除。

#### 权重策略

权重越高，被分配的请求越多

#### ip hash

每个请求按访问ip的hash结果分配，这样每个访客固定访问一个服务器后，可以解决session问题。

#### fair 第三方

根据请求的响应时间来分配，响应时间短的先分配



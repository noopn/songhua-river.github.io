---
layout: posts
title: ⑤独一无二-单例模式
mathjax: true
date: 2023-01-09 09:20:41
categories:
  - 设计模式
tags:
  - 设计模式
---

#### 单例模式

**确保一类只有一个实例，并提供全局访问点**。

这个模式很简单，目的就是让类只能被实例化一次，思路就是如果没有被实例化就实例化类，如果已经实例化直接返回实例化的对象。

因为在 JS 中，类的静态方法不能访问类的实例属性，所以考虑把类的实例缓存在类的静态属性中。

```ts
class Singleton {
  static instance: InstanceType<typeof Singleton> | null = null;
  static getInstance() {
    if (!this.instance) {
      return (this.instance = new Singleton());
    } else {
      return this.instance;
    }
  }
}
```

如果不使用 ES6 class 实现，可以使用函数的方式配合模块化规范，导出创建方法

```ts
interface ISingleton {}
interface ISingletonConstructor {
  new (): ISingleton;
}
class Singleton implements ISingleton {
  constructor() {}
}

let getSingletonInstance = (Singleton: ISingletonConstructor): ISingleton => {
  let instance: ISingleton = new Singleton();
  getSingletonInstance = (Singleton?: ISingletonConstructor): ISingleton =>
    instance;
  return instance;
};

export { getSingletonInstance };
```
